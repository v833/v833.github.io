<%
    var hashCode = function (str) {
        if (!str && str.length === 0) {
            return 0;
        }

        var hash = 0;
        for (var i = 0, len = str.length; i < len; i++) {
            hash = ((hash << 5) - hash) + str.charCodeAt(i);
            hash |= 0;
        }
        return hash;
    };
%>

<%
  var img = 'https://ssyerv1.oss-cn-hangzhou.aliyuncs.com/picture/ada660a8c596431983dddd411a12f2b3.jpg!sswm';
  var imgs = theme.imgs;
  if (!imgs || imgs.length === 0) {
      return img;
  }
  img = imgs[Math.abs(hashCode(post.title) % imgs.length)]
%>

<div class="post-detail-header lazyload" id="thumbnail_canvas" data-original="<%- url_for(post.img || post.swiperImg || img) %>" style="background-repeat: no-repeat; background-size: cover; 
  background-position: center center;position: relative;">
  <div class="post-detail-header-mask"></div>
  <canvas id="header_canvas"style="position:absolute;bottom:0;pointer-events:none;"></canvas>
  
  <div class="title-box">
    <span class="title">
      <%= post.title %>
    </span>
    <!-- id 将作为查询条件 -->
    <span id="<%- url_for(post.path) %>" class="leancloud-visitors view" data-flag-title="<%= post.title %>">
      <i class="post-meta-item-text">阅读数: </i>
      <i class="leancloud-visitors-count">loading</i>
    </span>
  </div>
  
  <% if (theme.bubble.on === true) { %>
    <script src="<%- url_for('/js/bubble/bubble.js') %>"></script>
  <% } %>
</div>

